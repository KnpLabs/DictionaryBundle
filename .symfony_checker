<?php

use Knp\DictionaryBundle\Dictionary\DictionaryRegistry;
use Knp\DictionaryBundle\KnpDictionaryBundle;
use Pedrotroller\Symfony\IntegrationChecker\ConfigurableKernel;
use Symfony\Component\DependencyInjection\ContainerBuilder;
use Symfony\Component\HttpKernel\KernelInterface;
use Webmozart\Assert\Assert;
use Knp\DictionaryBundle\Dictionary\Collection;

$test = function (KernelInterface $kernel) {
    if (false === $kernel->getContainer()->get(Collection::class) instanceof Collection) {
        throw new Exception('Service "Knp\DictionaryBundle\Dictionary\Collection" unavailable.');
    }
};

return function (ConfigurableKernel $kernel) use ($test) {
    $container = new ContainerBuilder();

    $kernel
        ->setContainerBuilder($container)
        ->addBundle(new KnpDictionaryBundle())
        ->afterBoot($test)
    ;
};
